---

  - name: Copiar archivo de credenciales de mysql
    ansible.builtin.copy:
      src: cosas/.my.cnf
      dest: /root

  - name: Iniciar servicio   
    ansible.builtin.systemd:
      state: restarted
      daemon_reload: yes
      name: mysqld 
    
  - name: leer log de MySql
    shell:
      cmd: cat /var/log/mysqld.log | grep "A temporary password"
    register: log_mysql

  - set_fact:
      log_var: "{{ log_mysql.stdout | regex_search('[^: ]*$') }}"

  - name: mostrar a ver
    debug:
      var: log_var

  - name: Copiar dump de la base de datos
    ansible.builtin.copy:
      src: cosas/MySqlDump.sql
      dest: /tmp
  
  - name: Importar base de datos
    community.mysql.mysql_db:
      #"{{ log_var }}"
      name: InfinitySports
      state: import
      target: /tmp/MySqlDump.sql
